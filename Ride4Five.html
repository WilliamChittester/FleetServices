<html>
<head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>

    <script>

        function eligable(val){
            var userLat;
            var userLon;
            var pAddress;
            var listIndex = 0;
            var currentConf = 0.80;

            function location(addressJson) {
                for (var i = 0; i < addressJson.features.length; i++) {
                    pAddress = addressJson.features[listIndex];
                    console.log(pAddress);

                    if (pAddress.properties.confidence > currentConf) {

                        userLat = pAddress.geometry.coordinates[1];
                        userLon = pAddress.geometry.coordinates[0];

                        currentConf = pAddress.properties.condifence;

                    }

                }
                console.log(userLon, userLat);
            }

            $.getJSON("https://search.mapzen.com/v1/search?text=" + val + "&api_key=search-8r189wE&boundary.circle.lon=-77.862849&boundary.circle.lat=40.797262&boundary.circle.radius=50", function(data) {
              console.log(data);
              location(data);
            });

            //// These lines won't work because they are executed as soon as possible, i.e. before the $.getJSON response callback
            // alert("address: " + val);
            // alert("address Lat: " + userLat);
            // alert("address Lon: " + userLon);
        }

    </script>

</head>

<body>

<input type="text" id="ad_search_query" style="width:295px">&nbsp;
<input type="button" value="Run Script" class="p-userButton" onClick="eligable(document.getElementById('ad_search_query').value);"/>





</body>

</html>
